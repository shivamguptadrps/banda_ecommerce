# Database Schema Documentation

**Generated:** 2026-01-14 09:51:05

**Database:** banda_ecommerce

---

## Table of Contents

- [alembic_version](#alembic-version)
- [attribute_segments](#attribute-segments)
- [cart_items](#cart-items)
- [carts](#carts)
- [categories](#categories)
- [category_attributes](#category-attributes)
- [coupon_usages](#coupon-usages)
- [coupons](#coupons)
- [delivery_addresses](#delivery-addresses)
- [delivery_history](#delivery-history)
- [delivery_partners](#delivery-partners)
- [inventory](#inventory)
- [notifications](#notifications)
- [order_items](#order-items)
- [orders](#orders)
- [payment_logs](#payment-logs)
- [payments](#payments)
- [product_attribute_values](#product-attribute-values)
- [product_images](#product-images)
- [products](#products)
- [refresh_tokens](#refresh-tokens)
- [refunds](#refunds)
- [return_requests](#return-requests)
- [sell_units](#sell-units)
- [service_zones](#service-zones)
- [stock_reservations](#stock-reservations)
- [users](#users)
- [vendor_payout_items](#vendor-payout-items)
- [vendor_payouts](#vendor-payouts)
- [vendors](#vendors)

---

## alembic_version

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `version_num` | `VARCHAR(32)` | ❌ | - | ❌ |

### Primary Keys

- `version_num`

---

## attribute_segments

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `category_id` | `UUID` | ❌ | - | ❌ |
| `name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `icon` | `VARCHAR(50)` | ✅ | - | ❌ |
| `display_order` | `INTEGER` | ❌ | 0 | ❌ |
| `is_collapsible` | `BOOLEAN` | ❌ | true | ❌ |
| `is_active` | `BOOLEAN` | ❌ | true | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **attribute_segments_category_id_fkey**: `category_id` → `categories(id)` ON DELETE CASCADE

### Indexes

- **ix_attribute_segments_category_id**: `category_id`
- **ix_attribute_segments_display_order**: `display_order`

---

## cart_items

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `cart_id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ❌ | - | ❌ |
| `sell_unit_id` | `UUID` | ❌ | - | ❌ |
| `quantity` | `INTEGER` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ❌ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **cart_items_cart_id_fkey**: `cart_id` → `carts(id)` ON DELETE CASCADE
- **cart_items_product_id_fkey**: `product_id` → `products(id)` ON DELETE CASCADE
- **cart_items_sell_unit_id_fkey**: `sell_unit_id` → `sell_units(id)` ON DELETE CASCADE

### Indexes

- **ix_cart_items_cart_id**: `cart_id`
- **ix_cart_items_product_id**: `product_id`
- **ix_cart_items_sell_unit_id**: `sell_unit_id`
- **uq_cart_sell_unit**: UNIQUE `cart_id, sell_unit_id`

### Unique Constraints

- **uq_cart_sell_unit**: `cart_id, sell_unit_id`

---

## carts

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `buyer_id` | `UUID` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `coupon_id` | `UUID` | ✅ | - | ❌ |
| `discount_amount` | `NUMERIC(10, 2)` | ❌ | 0.00 | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **carts_buyer_id_fkey**: `buyer_id` → `users(id)` ON DELETE CASCADE
- **fk_carts_coupon**: `coupon_id` → `coupons(id)` ON DELETE SET NULL

### Indexes

- **ix_carts_buyer_id**: UNIQUE `buyer_id`
- **ix_carts_coupon_id**: `coupon_id`

---

## categories

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `slug` | `VARCHAR(100)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `image_url` | `VARCHAR(500)` | ✅ | - | ❌ |
| `parent_id` | `UUID` | ✅ | - | ❌ |
| `display_order` | `INTEGER` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **categories_parent_id_fkey**: `parent_id` → `categories(id)` ON DELETE SET NULL

### Indexes

- **ix_categories_parent_id**: `parent_id`
- **ix_categories_slug**: UNIQUE `slug`

---

## category_attributes

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `category_id` | `UUID` | ❌ | - | ❌ |
| `name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `slug` | `VARCHAR(100)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `attribute_type` | `VARCHAR(12)` | ❌ | - | ❌ |
| `options` | `JSON` | ✅ | - | ❌ |
| `unit` | `VARCHAR(20)` | ✅ | - | ❌ |
| `is_required` | `BOOLEAN` | ❌ | - | ❌ |
| `is_inherited` | `BOOLEAN` | ❌ | - | ❌ |
| `is_filterable` | `BOOLEAN` | ❌ | - | ❌ |
| `is_searchable` | `BOOLEAN` | ❌ | - | ❌ |
| `display_order` | `INTEGER` | ❌ | - | ❌ |
| `show_in_listing` | `BOOLEAN` | ❌ | - | ❌ |
| `show_in_details` | `BOOLEAN` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `segment_id` | `UUID` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **category_attributes_category_id_fkey**: `category_id` → `categories(id)` ON DELETE CASCADE
- **fk_category_attributes_segment_id**: `segment_id` → `attribute_segments(id)` ON DELETE SET NULL

### Indexes

- **ix_category_attributes_category_id**: `category_id`
- **ix_category_attributes_segment_id**: `segment_id`
- **ix_category_attributes_slug**: `slug`

---

## coupon_usages

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `coupon_id` | `UUID` | ❌ | - | ❌ |
| `user_id` | `UUID` | ✅ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `discount_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **coupon_usages_coupon_id_fkey**: `coupon_id` → `coupons(id)` ON DELETE CASCADE
- **coupon_usages_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE
- **coupon_usages_user_id_fkey**: `user_id` → `users(id)` ON DELETE SET NULL

### Indexes

- **ix_coupon_usages_coupon_id**: `coupon_id`
- **ix_coupon_usages_order_id**: `order_id`
- **ix_coupon_usages_user_id**: `user_id`

---

## coupons

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `code` | `VARCHAR(50)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `discount_type` | `VARCHAR(20)` | ❌ | - | ❌ |
| `discount_value` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `min_order_amount` | `NUMERIC(10, 2)` | ❌ | 0.00 | ❌ |
| `max_discount` | `NUMERIC(10, 2)` | ✅ | - | ❌ |
| `expiry_date` | `TIMESTAMP` | ✅ | - | ❌ |
| `usage_limit` | `INTEGER` | ✅ | - | ❌ |
| `used_count` | `INTEGER` | ❌ | 0 | ❌ |
| `is_active` | `BOOLEAN` | ❌ | true | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Indexes

- **ix_coupons_code**: UNIQUE `code`
- **ix_coupons_is_active**: `is_active`

---

## delivery_addresses

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `buyer_id` | `UUID` | ❌ | - | ❌ |
| `label` | `VARCHAR(50)` | ❌ | - | ❌ |
| `recipient_name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `recipient_phone` | `VARCHAR(15)` | ❌ | - | ❌ |
| `address_line_1` | `VARCHAR(255)` | ❌ | - | ❌ |
| `address_line_2` | `VARCHAR(255)` | ✅ | - | ❌ |
| `city` | `VARCHAR(100)` | ❌ | - | ❌ |
| `state` | `VARCHAR(100)` | ❌ | - | ❌ |
| `pincode` | `VARCHAR(10)` | ❌ | - | ❌ |
| `landmark` | `VARCHAR(255)` | ✅ | - | ❌ |
| `latitude` | `NUMERIC(10, 8)` | ✅ | - | ❌ |
| `longitude` | `NUMERIC(11, 8)` | ✅ | - | ❌ |
| `is_default` | `BOOLEAN` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **delivery_addresses_buyer_id_fkey**: `buyer_id` → `users(id)` ON DELETE CASCADE

### Indexes

- **ix_delivery_addresses_buyer_id**: `buyer_id`

---

## delivery_history

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `delivery_partner_id` | `UUID` | ❌ | - | ❌ |
| `attempt_number` | `INTEGER` | ❌ | - | ❌ |
| `status` | `VARCHAR(20)` | ❌ | - | ❌ |
| `is_cod` | `BOOLEAN` | ❌ | - | ❌ |
| `cod_amount` | `NUMERIC(10, 2)` | ✅ | - | ❌ |
| `cod_collected` | `BOOLEAN` | ✅ | - | ❌ |
| `cod_collected_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `failure_reason` | `VARCHAR(50)` | ✅ | - | ❌ |
| `failure_notes` | `TEXT` | ✅ | - | ❌ |
| `assigned_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `attempted_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `completed_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `delivery_time_minutes` | `INTEGER` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **delivery_history_delivery_partner_id_fkey**: `delivery_partner_id` → `delivery_partners(id)` ON DELETE CASCADE
- **delivery_history_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE

### Indexes

- **ix_delivery_history_delivery_partner_id**: `delivery_partner_id`
- **ix_delivery_history_order_id**: `order_id`

---

## delivery_partners

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `user_id` | `UUID` | ❌ | - | ❌ |
| `name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `phone` | `VARCHAR(15)` | ❌ | - | ❌ |
| `vehicle_type` | `VARCHAR(50)` | ✅ | - | ❌ |
| `vehicle_number` | `VARCHAR(20)` | ✅ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | true | ❌ |
| `is_available` | `BOOLEAN` | ❌ | true | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **delivery_partners_user_id_fkey**: `user_id` → `users(id)` ON DELETE CASCADE

### Indexes

- **ix_delivery_partners_phone**: UNIQUE `phone`
- **ix_delivery_partners_user_id**: UNIQUE `user_id`

---

## inventory

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ❌ | - | ❌ |
| `available_quantity` | `NUMERIC(10, 3)` | ❌ | - | ❌ |
| `reserved_quantity` | `NUMERIC(10, 3)` | ❌ | - | ❌ |
| `low_stock_threshold` | `NUMERIC(10, 3)` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ❌ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **inventory_product_id_fkey**: `product_id` → `products(id)` ON DELETE CASCADE

### Indexes

- **ix_inventory_product_id**: UNIQUE `product_id`

---

## notifications

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `user_id` | `UUID` | ❌ | - | ❌ |
| `type` | `VARCHAR(50)` | ❌ | - | ❌ |
| `priority` | `VARCHAR(20)` | ❌ | - | ❌ |
| `title` | `VARCHAR(200)` | ❌ | - | ❌ |
| `message` | `TEXT` | ❌ | - | ❌ |
| `action_url` | `VARCHAR(500)` | ✅ | - | ❌ |
| `action_label` | `VARCHAR(50)` | ✅ | - | ❌ |
| `related_entity_type` | `VARCHAR(50)` | ✅ | - | ❌ |
| `related_entity_id` | `UUID` | ✅ | - | ❌ |
| `extra_data` | `TEXT` | ✅ | - | ❌ |
| `is_read` | `BOOLEAN` | ❌ | - | ❌ |
| `read_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **notifications_user_id_fkey**: `user_id` → `users(id)` ON DELETE CASCADE

### Indexes

- **ix_notifications_created_at**: `created_at`
- **ix_notifications_is_read**: `is_read`
- **ix_notifications_related_entity_id**: `related_entity_id`
- **ix_notifications_type**: `type`
- **ix_notifications_user_id**: `user_id`

---

## order_items

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ✅ | - | ❌ |
| `sell_unit_id` | `UUID` | ✅ | - | ❌ |
| `product_name` | `VARCHAR(255)` | ❌ | - | ❌ |
| `sell_unit_label` | `VARCHAR(50)` | ❌ | - | ❌ |
| `unit_value` | `NUMERIC(10, 3)` | ❌ | - | ❌ |
| `quantity` | `INTEGER` | ❌ | - | ❌ |
| `price_per_unit` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `total_price` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `return_eligible` | `BOOLEAN` | ❌ | false | ❌ |
| `return_window_days` | `INTEGER` | ✅ | - | ❌ |
| `return_deadline` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **order_items_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE
- **order_items_product_id_fkey**: `product_id` → `products(id)` ON DELETE SET NULL
- **order_items_sell_unit_id_fkey**: `sell_unit_id` → `sell_units(id)` ON DELETE SET NULL

### Indexes

- **ix_order_items_order_id**: `order_id`

---

## orders

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_number` | `VARCHAR(20)` | ❌ | - | ❌ |
| `buyer_id` | `UUID` | ✅ | - | ❌ |
| `vendor_id` | `UUID` | ✅ | - | ❌ |
| `delivery_address_id` | `UUID` | ✅ | - | ❌ |
| `delivery_address_snapshot` | `TEXT` | ✅ | - | ❌ |
| `delivery_latitude` | `NUMERIC(10, 8)` | ✅ | - | ❌ |
| `delivery_longitude` | `NUMERIC(11, 8)` | ✅ | - | ❌ |
| `delivery_distance_km` | `NUMERIC(5, 2)` | ✅ | - | ❌ |
| `subtotal` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `delivery_fee` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `discount_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `tax_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `total_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `payment_mode` | `VARCHAR(20)` | ❌ | - | ❌ |
| `payment_status` | `VARCHAR(20)` | ❌ | - | ❌ |
| `order_status` | `VARCHAR(50)` | ❌ | - | ❌ |
| `notes` | `TEXT` | ✅ | - | ❌ |
| `cancellation_reason` | `TEXT` | ✅ | - | ❌ |
| `placed_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `confirmed_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `processing_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `shipped_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `delivered_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `cancelled_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `picked_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `packed_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `out_for_delivery_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `delivery_partner_id` | `UUID` | ✅ | - | ❌ |
| `delivery_otp` | `VARCHAR(6)` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **fk_orders_delivery_partner_id**: `delivery_partner_id` → `delivery_partners(id)` ON DELETE SET NULL
- **orders_buyer_id_fkey**: `buyer_id` → `users(id)` ON DELETE SET NULL
- **orders_delivery_address_id_fkey**: `delivery_address_id` → `delivery_addresses(id)` ON DELETE SET NULL
- **orders_vendor_id_fkey**: `vendor_id` → `vendors(id)` ON DELETE SET NULL

### Indexes

- **ix_orders_buyer_id**: `buyer_id`
- **ix_orders_delivery_otp**: `delivery_otp`
- **ix_orders_delivery_partner_id**: `delivery_partner_id`
- **ix_orders_order_number**: UNIQUE `order_number`
- **ix_orders_order_status**: `order_status`
- **ix_orders_vendor_id**: `vendor_id`

---

## payment_logs

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `payment_id` | `UUID` | ❌ | - | ❌ |
| `event_type` | `VARCHAR(50)` | ❌ | - | ❌ |
| `payload` | `JSON` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **payment_logs_payment_id_fkey**: `payment_id` → `payments(id)` ON DELETE CASCADE

### Indexes

- **ix_payment_logs_event_type**: `event_type`
- **ix_payment_logs_payment_id**: `payment_id`

---

## payments

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `razorpay_order_id` | `VARCHAR(100)` | ✅ | - | ❌ |
| `razorpay_payment_id` | `VARCHAR(100)` | ✅ | - | ❌ |
| `razorpay_signature` | `VARCHAR(255)` | ✅ | - | ❌ |
| `amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `currency` | `VARCHAR(10)` | ❌ | 'INR'::character varying | ❌ |
| `status` | `VARCHAR(10)` | ❌ | 'PENDING'::paymentstatus | ❌ |
| `method` | `VARCHAR(50)` | ✅ | - | ❌ |
| `failure_reason` | `TEXT` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **payments_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE

### Indexes

- **ix_payments_order_id**: `order_id`
- **ix_payments_razorpay_order_id**: `razorpay_order_id`
- **ix_payments_razorpay_payment_id**: `razorpay_payment_id`
- **ix_payments_status**: `status`

---

## product_attribute_values

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ❌ | - | ❌ |
| `attribute_id` | `UUID` | ❌ | - | ❌ |
| `value` | `TEXT` | ❌ | - | ❌ |
| `value_json` | `JSON` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **product_attribute_values_attribute_id_fkey**: `attribute_id` → `category_attributes(id)` ON DELETE CASCADE
- **product_attribute_values_product_id_fkey**: `product_id` → `products(id)` ON DELETE CASCADE

### Indexes

- **ix_product_attribute_values_attribute_id**: `attribute_id`
- **ix_product_attribute_values_product_id**: `product_id`

---

## product_images

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ❌ | - | ❌ |
| `image_url` | `VARCHAR(500)` | ❌ | - | ❌ |
| `display_order` | `INTEGER` | ❌ | - | ❌ |
| `is_primary` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **product_images_product_id_fkey**: `product_id` → `products(id)` ON DELETE CASCADE

### Indexes

- **ix_product_images_product_id**: `product_id`

---

## products

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `vendor_id` | `UUID` | ❌ | - | ❌ |
| `category_id` | `UUID` | ✅ | - | ❌ |
| `name` | `VARCHAR(255)` | ❌ | - | ❌ |
| `slug` | `VARCHAR(255)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `stock_unit` | `VARCHAR(5)` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `is_deleted` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `return_eligible` | `BOOLEAN` | ❌ | false | ❌ |
| `return_window_days` | `INTEGER` | ✅ | - | ❌ |
| `return_conditions` | `TEXT` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **products_category_id_fkey**: `category_id` → `categories(id)` ON DELETE SET NULL
- **products_vendor_id_fkey**: `vendor_id` → `vendors(id)` ON DELETE CASCADE

### Indexes

- **ix_products_category_id**: `category_id`
- **ix_products_slug**: `slug`
- **ix_products_vendor_id**: `vendor_id`

---

## refresh_tokens

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `user_id` | `UUID` | ❌ | - | ❌ |
| `token` | `TEXT` | ❌ | - | ❌ |
| `expires_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `is_revoked` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **refresh_tokens_user_id_fkey**: `user_id` → `users(id)` ON DELETE CASCADE

### Indexes

- **ix_refresh_tokens_user_id**: `user_id`
- **refresh_tokens_token_key**: UNIQUE `token`

### Unique Constraints

- **refresh_tokens_token_key**: `token`

---

## refunds

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `payment_id` | `UUID` | ✅ | - | ❌ |
| `return_request_id` | `UUID` | ✅ | - | ❌ |
| `amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `razorpay_refund_id` | `VARCHAR(100)` | ✅ | - | ❌ |
| `status` | `VARCHAR(50)` | ❌ | 'initiated'::character varying | ❌ |
| `failure_reason` | `TEXT` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `processed_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **refunds_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE
- **refunds_payment_id_fkey**: `payment_id` → `payments(id)` ON DELETE SET NULL
- **refunds_return_request_id_fkey**: `return_request_id` → `return_requests(id)` ON DELETE SET NULL

### Indexes

- **ix_refunds_order_id**: `order_id`
- **ix_refunds_payment_id**: `payment_id`
- **ix_refunds_razorpay_refund_id**: `razorpay_refund_id`
- **ix_refunds_return_request_id**: `return_request_id`
- **ix_refunds_status**: `status`
- **refunds_return_request_id_key**: UNIQUE `return_request_id`

### Unique Constraints

- **refunds_return_request_id_key**: `return_request_id`

---

## return_requests

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `order_item_id` | `UUID` | ❌ | - | ❌ |
| `buyer_id` | `UUID` | ✅ | - | ❌ |
| `reason` | `VARCHAR(50)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `images` | `JSON` | ✅ | - | ❌ |
| `status` | `VARCHAR(50)` | ❌ | 'requested'::character varying | ❌ |
| `refund_amount` | `NUMERIC(10, 2)` | ❌ | 0.00 | ❌ |
| `admin_notes` | `TEXT` | ✅ | - | ❌ |
| `vendor_notes` | `TEXT` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `resolved_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **return_requests_buyer_id_fkey**: `buyer_id` → `users(id)` ON DELETE SET NULL
- **return_requests_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE
- **return_requests_order_item_id_fkey**: `order_item_id` → `order_items(id)` ON DELETE CASCADE

### Indexes

- **ix_return_requests_buyer_id**: `buyer_id`
- **ix_return_requests_order_id**: `order_id`
- **ix_return_requests_order_item_id**: `order_item_id`
- **ix_return_requests_status**: `status`

---

## sell_units

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ❌ | - | ❌ |
| `label` | `VARCHAR(50)` | ❌ | - | ❌ |
| `unit_value` | `NUMERIC(10, 3)` | ❌ | - | ❌ |
| `price` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `compare_price` | `NUMERIC(10, 2)` | ✅ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **sell_units_product_id_fkey**: `product_id` → `products(id)` ON DELETE CASCADE

### Indexes

- **ix_sell_units_product_id**: `product_id`

---

## service_zones

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `zone_name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `city` | `VARCHAR(100)` | ❌ | - | ❌ |
| `center_latitude` | `NUMERIC(10, 8)` | ✅ | - | ❌ |
| `center_longitude` | `NUMERIC(11, 8)` | ✅ | - | ❌ |
| `radius_km` | `NUMERIC(5, 2)` | ❌ | - | ❌ |
| `delivery_fee` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `min_order_value` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `estimated_time_mins` | `INTEGER` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Indexes

- **ix_service_zones_city**: `city`

---

## stock_reservations

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ❌ | - | ❌ |
| `product_id` | `UUID` | ❌ | - | ❌ |
| `reserved_quantity` | `NUMERIC(10, 3)` | ❌ | - | ❌ |
| `expires_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `status` | `VARCHAR(20)` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `confirmed_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `released_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **stock_reservations_order_id_fkey**: `order_id` → `orders(id)` ON DELETE CASCADE
- **stock_reservations_product_id_fkey**: `product_id` → `products(id)` ON DELETE CASCADE

### Indexes

- **ix_stock_reservations_order_id**: `order_id`
- **ix_stock_reservations_product_id**: `product_id`
- **ix_stock_reservations_status**: `status`

---

## users

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `email` | `VARCHAR(255)` | ❌ | - | ❌ |
| `phone` | `VARCHAR(15)` | ✅ | - | ❌ |
| `password_hash` | `VARCHAR(255)` | ❌ | - | ❌ |
| `name` | `VARCHAR(100)` | ❌ | - | ❌ |
| `role` | `VARCHAR(20)` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `is_email_verified` | `BOOLEAN` | ❌ | - | ❌ |
| `last_login` | `TIMESTAMP` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Indexes

- **ix_users_email**: UNIQUE `email`
- **ix_users_phone**: UNIQUE `phone`

---

## vendor_payout_items

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `payout_id` | `UUID` | ❌ | - | ❌ |
| `order_id` | `UUID` | ✅ | - | ❌ |
| `order_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `commission` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `net_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **vendor_payout_items_order_id_fkey**: `order_id` → `orders(id)` ON DELETE SET NULL
- **vendor_payout_items_payout_id_fkey**: `payout_id` → `vendor_payouts(id)` ON DELETE CASCADE

### Indexes

- **ix_vendor_payout_items_order_id**: `order_id`
- **ix_vendor_payout_items_payout_id**: `payout_id`

---

## vendor_payouts

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `vendor_id` | `UUID` | ❌ | - | ❌ |
| `period_start` | `DATE` | ❌ | - | ❌ |
| `period_end` | `DATE` | ❌ | - | ❌ |
| `total_orders` | `INTEGER` | ❌ | 0 | ❌ |
| `gross_amount` | `NUMERIC(10, 2)` | ❌ | 0.00 | ❌ |
| `commission_amount` | `NUMERIC(10, 2)` | ❌ | 0.00 | ❌ |
| `refund_deductions` | `NUMERIC(10, 2)` | ❌ | 0.00 | ❌ |
| `net_amount` | `NUMERIC(10, 2)` | ❌ | - | ❌ |
| `status` | `VARCHAR(50)` | ❌ | 'pending'::character varying | ❌ |
| `transaction_id` | `VARCHAR(100)` | ✅ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | now() | ❌ |
| `processed_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **vendor_payouts_vendor_id_fkey**: `vendor_id` → `vendors(id)` ON DELETE CASCADE

### Indexes

- **ix_vendor_payouts_status**: `status`
- **ix_vendor_payouts_transaction_id**: `transaction_id`
- **ix_vendor_payouts_vendor_id**: `vendor_id`

---

## vendors

### Columns

| Column | Type | Nullable | Default | Auto Increment |
|--------|------|----------|---------|----------------|
| `id` | `UUID` | ❌ | - | ❌ |
| `user_id` | `UUID` | ❌ | - | ❌ |
| `shop_name` | `VARCHAR(255)` | ❌ | - | ❌ |
| `description` | `TEXT` | ✅ | - | ❌ |
| `logo_url` | `VARCHAR(500)` | ✅ | - | ❌ |
| `address_line_1` | `VARCHAR(255)` | ❌ | - | ❌ |
| `address_line_2` | `VARCHAR(255)` | ✅ | - | ❌ |
| `city` | `VARCHAR(100)` | ❌ | - | ❌ |
| `state` | `VARCHAR(100)` | ❌ | - | ❌ |
| `pincode` | `VARCHAR(10)` | ❌ | - | ❌ |
| `latitude` | `NUMERIC(10, 8)` | ✅ | - | ❌ |
| `longitude` | `NUMERIC(11, 8)` | ✅ | - | ❌ |
| `delivery_radius_km` | `NUMERIC(5, 2)` | ❌ | - | ❌ |
| `phone` | `VARCHAR(15)` | ✅ | - | ❌ |
| `is_verified` | `BOOLEAN` | ❌ | - | ❌ |
| `is_active` | `BOOLEAN` | ❌ | - | ❌ |
| `rating` | `NUMERIC(2, 1)` | ❌ | - | ❌ |
| `total_orders` | `INTEGER` | ❌ | - | ❌ |
| `total_reviews` | `INTEGER` | ❌ | - | ❌ |
| `commission_percent` | `NUMERIC(4, 2)` | ❌ | - | ❌ |
| `cod_enabled` | `BOOLEAN` | ❌ | - | ❌ |
| `created_at` | `TIMESTAMP` | ❌ | - | ❌ |
| `updated_at` | `TIMESTAMP` | ✅ | - | ❌ |
| `verified_at` | `TIMESTAMP` | ✅ | - | ❌ |

### Primary Keys

- `id`

### Foreign Keys

- **vendors_user_id_fkey**: `user_id` → `users(id)` ON DELETE CASCADE

### Indexes

- **ix_vendors_city**: `city`
- **ix_vendors_user_id**: UNIQUE `user_id`

---

